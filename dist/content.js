/*! For license information please see content.js.LICENSE.txt */
(()=>{function e(){var r,n,o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function a(e,o,c,i){var a=o&&o.prototype instanceof f?o:f,s=Object.create(a.prototype);return t(s,"_invoke",function(e,t,o){var c,i,a,f=0,s=o||[],l=!1,p={p:0,n:0,v:r,a:d,f:d.bind(r,4),d:function(e,t){return c=e,i=0,a=r,p.n=t,u}};function d(e,t){for(i=e,a=t,n=0;!l&&f&&!o&&n<s.length;n++){var o,c=s[n],d=p.p,y=c[2];e>3?(o=y===t)&&(a=c[(i=c[4])?5:(i=3,3)],c[4]=c[5]=r):c[0]<=d&&((o=e<2&&d<c[1])?(i=0,p.v=t,p.n=c[1]):d<y&&(o=e<3||c[0]>t||t>y)&&(c[4]=e,c[5]=t,p.n=y,i=0))}if(o||e>1)return u;throw l=!0,t}return function(o,s,y){if(f>1)throw TypeError("Generator is already running");for(l&&1===s&&d(s,y),i=s,a=y;(n=i<2?r:a)||!l;){c||(i?i<3?(i>1&&(p.n=-1),d(i,a)):p.n=a:p.v=a);try{if(f=2,c){if(i||(o="next"),n=c[o]){if(!(n=n.call(c,a)))throw TypeError("iterator result is not an object");if(!n.done)return n;a=n.value,i<2&&(i=0)}else 1===i&&(n=c.return)&&n.call(c),i<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),i=1);c=r}else if((n=(l=p.n<0)?a:e.call(t,p))!==u)break}catch(e){c=r,i=1,a=e}finally{f=1}}return{value:n,done:l}}}(e,c,i),!0),s}var u={};function f(){}function s(){}function l(){}n=Object.getPrototypeOf;var p=[][c]?n(n([][c]())):(t(n={},c,function(){return this}),n),d=l.prototype=f.prototype=Object.create(p);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,t(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=l,t(d,"constructor",l),t(l,"constructor",s),s.displayName="GeneratorFunction",t(l,i,"GeneratorFunction"),t(d),t(d,i,"Generator"),t(d,c,function(){return this}),t(d,"toString",function(){return"[object Generator]"}),(e=function(){return{w:a,m:y}})()}function t(e,r,n,o){var c=Object.defineProperty;try{c({},"",{})}catch(e){c=0}t=function(e,r,n,o){function i(r,n){t(e,r,function(e){return this._invoke(r,n,e)})}r?c?c(e,r,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[r]=n:(i("next",0),i("throw",1),i("return",2))},t(e,r,n,o)}function r(e,t,r,n,o,c,i){try{var a=e[c](i),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,o)}function n(e){return function(){var t=this,n=arguments;return new Promise(function(o,c){var i=e.apply(t,n);function a(e){r(i,o,c,a,u,"next",e)}function u(e){r(i,o,c,a,u,"throw",e)}a(void 0)})}}function o(){try{return document.body.innerText||""}catch(e){return console.error("Text extraction error:",e),""}}function c(e){return e.split(/[.!?]\s+/).map(function(e){return e.trim()}).filter(function(e){return e.length>20})}function i(e,t){e.forEach(function(e,r){var n=t[r];if(n&&n.flagged)for(var o=new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"),c=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT);c.nextNode();){var i=c.currentNode;if(o.test(i.textContent)){var a=document.createElement("span");a.style.background="rgba(255,0,0,0.3)",a.style.borderRadius="4px",a.style.padding="2px",a.title="Fake News Risk: ".concat(Math.round(100*n.confidence),"%");var u=document.createElement("span");u.textContent="⚠️ ".concat(Math.round(100*n.confidence),"%"),u.style.marginLeft="4px",u.style.fontSize="0.8em",u.style.color="red",a.textContent=e,i.parentNode.replaceChild(a,i),a.appendChild(u);break}}})}function a(e){return u.apply(this,arguments)}function u(){return(u=n(e().m(function t(r){return e().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e){chrome.runtime.sendMessage({type:"analyze_claims",claims:r},function(t){chrome.runtime.lastError?(console.error("Message error:",chrome.runtime.lastError),e([])):e((null==t?void 0:t.results)||[])})}))},t)}))).apply(this,arguments)}function f(){return s.apply(this,arguments)}function s(){return(s=n(e().m(function t(){var r,n,u,f;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,r=o(),0!==(n=c(r)).length){e.n=1;break}return e.a(2);case 1:return e.n=2,a(n);case 2:u=e.v,i(n,u),e.n=4;break;case 3:e.p=3,f=e.v,console.error("Scan error:",f);case 4:return e.a(2)}},t,null,[[0,3]])}))).apply(this,arguments)}var l;f(),new MutationObserver(function(){clearTimeout(l),l=setTimeout(f,1e3)}).observe(document.body,{childList:!0,subtree:!0}),chrome.runtime.onMessage.addListener(function(e,t,r){"scan_results"===e.type&&(i(e.claims,e.results),r({status:"ok"}))});try{Array.from(document.getElementsByTagName("iframe")).forEach(function(e){var t;null===(t=e.contentWindow)||void 0===t||t.postMessage({type:"xverify_scan"},"*")})}catch(e){console.warn("Iframe scan error:",e)}})();